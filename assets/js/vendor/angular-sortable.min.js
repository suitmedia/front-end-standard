!function(e,t,o){"use strict";t.module("ui.sortable",[]).value("uiSortableConfig",{items:"> [ng-repeat],> [data-ng-repeat],> [x-ng-repeat]"}).directive("uiSortable",["uiSortableConfig","$timeout","$log",function(e,n,i){return{require:"?ngModel",scope:{ngModel:"=",uiSortable:"=",create:"&uiSortableCreate",start:"&uiSortableStart",activate:"&uiSortableActivate",beforeStop:"&uiSortableBeforeStop",update:"&uiSortableUpdate",remove:"&uiSortableRemove",receive:"&uiSortableReceive",deactivate:"&uiSortableDeactivate",stop:"&uiSortableStop"},link:function(r,l,a,u){function s(e,t){var o="function"==typeof e,n="function"==typeof t;return o&&n?function(){e.apply(this,arguments),t.apply(this,arguments)}:n?t:e}function c(e){var t=e.data("ui-sortable");return t&&"object"==typeof t&&"ui-sortable"===t.widgetFullName?t:null}function d(t,o){return U[t]?("stop"===t&&(o=s(o,function(){r.$apply()}),o=s(o,S)),o=s(U[t],o)):V[t]&&(o=V[t](o)),o||"items"!==t&&"ui-model-items"!==t||(o=e.items),o}function f(e,n,i){function r(e,t){t in w||(w[t]=null)}t.forEach(U,r);var l=null;if(n){var a;t.forEach(n,function(n,i){if(!(e&&i in e)){if(i in M)return void(w[i]="ui-floating"===i?"auto":d(i,o));a||(a=t.element.ui.sortable().options);var r=a[i];r=d(i,r),l||(l={}),l[i]=r,w[i]=r}})}return t.forEach(e,function(e,t){return t in M?("ui-floating"!==t||!1!==e&&!0!==e||!i||(i.floating=e),void(w[t]=d(t,e))):(e=d(t,e),l||(l={}),l[t]=e,void(w[t]=e))}),l}function m(e){var o=e.sortable("option","placeholder");if(o&&o.element&&"function"==typeof o.element){var n=o.element();return n=t.element(n)}return null}function b(e,t){var o=w["ui-model-items"].replace(/[^,]*>/g,"");return e.find('[class="'+t.attr("class")+'"]:not('+o+")")}function p(e,t){var o=e.sortable("option","helper");return"clone"===o||"function"==typeof o&&t.item.sortable.isCustomHelperUsed()}function v(e,t){var o=null;return p(e,t)&&"parent"===e.sortable("option","appendTo")&&(o=E),o}function g(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))}function h(e,t){for(var o=0;o<e.length;o++){var n=e[o];if(n.element[0]===t[0])return n}}function S(e,t){t.item.sortable._destroy()}function C(e){return e.parent().find(w["ui-model-items"]).index(e)}function y(){r.$watchCollection("ngModel",function(){n(function(){c(l)&&l.sortable("refresh")},0,!1)}),U.start=function(e,n){if("auto"===w["ui-floating"]){var i=n.item.siblings();c(t.element(e.target)).floating=g(i)}var r=C(n.item);n.item.sortable={model:u.$modelValue[r],index:r,source:l,sourceList:n.item.parent(),sourceModel:u.$modelValue,cancel:function(){n.item.sortable._isCanceled=!0},isCanceled:function(){return n.item.sortable._isCanceled},isCustomHelperUsed:function(){return!!n.item.sortable._isCustomHelperUsed},_isCanceled:!1,_isCustomHelperUsed:n.item.sortable._isCustomHelperUsed,_destroy:function(){t.forEach(n.item.sortable,function(e,t){n.item.sortable[t]=o})},_connectedSortables:[],_getElementContext:function(e){return h(this._connectedSortables,e)}}},U.activate=function(e,t){var o=t.item.sortable.source===l,n=o?t.item.sortable.sourceList:l,i={element:l,scope:r,isSourceContext:o,savedNodesOrigin:n};t.item.sortable._connectedSortables.push(i),_=n.contents(),E=t.helper;var a=m(l);if(a&&a.length){var u=b(l,a);_=_.not(u)}},U.update=function(e,t){if(!t.item.sortable.received){t.item.sortable.dropindex=C(t.item);var o=t.item.closest("[ui-sortable], [data-ui-sortable], [x-ui-sortable]");t.item.sortable.droptarget=o,t.item.sortable.droptargetList=t.item.parent();var n=t.item.sortable._getElementContext(o);t.item.sortable.droptargetModel=n.scope.ngModel,l.sortable("cancel")}var i=!t.item.sortable.received&&v(l,t,_);i&&i.length&&(_=_.not(i));var a=t.item.sortable._getElementContext(l);_.appendTo(a.savedNodesOrigin),t.item.sortable.received&&(_=null),t.item.sortable.received&&!t.item.sortable.isCanceled()&&(r.$apply(function(){u.$modelValue.splice(t.item.sortable.dropindex,0,t.item.sortable.moved)}),r.$emit("ui-sortable:moved",t))},U.stop=function(e,o){var n="dropindex"in o.item.sortable&&!o.item.sortable.isCanceled();if(n&&!o.item.sortable.received)r.$apply(function(){u.$modelValue.splice(o.item.sortable.dropindex,0,u.$modelValue.splice(o.item.sortable.index,1)[0])}),r.$emit("ui-sortable:moved",o);else if(!n&&!t.equals(l.contents().toArray(),_.toArray())){var i=v(l,o,_);i&&i.length&&(_=_.not(i));var a=o.item.sortable._getElementContext(l);_.appendTo(a.savedNodesOrigin)}_=null,E=null},U.receive=function(e,t){t.item.sortable.received=!0},U.remove=function(e,t){"dropindex"in t.item.sortable||(l.sortable("cancel"),t.item.sortable.cancel()),t.item.sortable.isCanceled()||r.$apply(function(){t.item.sortable.moved=u.$modelValue.splice(t.item.sortable.index,1)[0]})},t.forEach(U,function(e,t){U[t]=s(U[t],function(){var e,o=r[t];"function"==typeof o&&("uiSortable"+t.substring(0,1).toUpperCase()+t.substring(1)).length&&"function"==typeof(e=o())&&e.apply(this,arguments)})}),V.helper=function(e){return e&&"function"==typeof e?function(n,i){var r=i.sortable,a=C(i);i.sortable={model:u.$modelValue[a],index:a,source:l,sourceList:i.parent(),sourceModel:u.$modelValue,_restore:function(){t.forEach(i.sortable,function(e,t){i.sortable[t]=o}),i.sortable=r}};var s=e.apply(this,arguments);return i.sortable._restore(),i.sortable._isCustomHelperUsed=i!==s,s}:e},r.$watchCollection("uiSortable",function(e,t){var o=c(l);if(o){var n=f(e,t,o);n&&l.sortable("option",n)}},!0),f(w)}function $(){u?y():i.info("ui.sortable: ngModel not provided!",l),l.sortable(w)}function x(){return(!r.uiSortable||!r.uiSortable.disabled)&&($(),x.cancelWatcher(),x.cancelWatcher=t.noop,!0)}var _,E,w={},M={"ui-floating":o,"ui-model-items":e.items},U={create:null,start:null,activate:null,beforeStop:null,update:null,remove:null,receive:null,deactivate:null,stop:null},V={helper:null};return t.extend(w,M,e,r.uiSortable),t.element.fn&&t.element.fn.jquery?(x.cancelWatcher=t.noop,void(x()||(x.cancelWatcher=r.$watch("uiSortable.disabled",x)))):void i.error("ui.sortable: jQuery should be included before AngularJS!")}}}])}(window,window.angular);